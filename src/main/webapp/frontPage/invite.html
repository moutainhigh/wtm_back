<!--<!DOCTYPE html>-->
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0" name="viewport" />
    <link href="../code/css/base.css" rel="stylesheet" type="text/css"/>
    <link href="../code/css/style.css" rel="stylesheet" type="text/css"/>
    <title>邀请页</title>
    <script src="../code/js/jquery.min.js"></script>
    <script type="text/javascript" src="../code/js/jquery.zclip.min.js"></script>
    <script type="text/javascript" src="../code/js/clipboard.js"></script>
    <script type="text/javascript" src="../code/js/invite.js"></script>
    <script type="text/javascript" src="../code/js/time_js.js"></script>
    <script>
        var u = navigator.userAgent;
        var isAndroid = u.indexOf('Android') > -1 || u.indexOf('Adr') > -1;//android终端
        var isiOS = !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);// ios终端

        var memberId;
        function GetQueryString(name)
        {
            var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
            var r = window.location.search.substr(1).match(reg);
            if(r!=null)return  unescape(r[2]);return null;
        }
        $(function(){
            memberId=GetQueryString("memberId");
            console.log("获取的的数据为："+memberId)
            $.ajax({
                type: 'get',
                dataType: 'json',
                url: '/pc/admin/member/getInvitedCode',
                data: {memberId:memberId},
                header:{
                    "Access-Control-Allow-Origin":"true"
                },
                success: function (params) {
                    var json = eval(params); //数组
                    console.log("json数据为："+params)
                    if (json!=null&&json.errorCode==0){
                        $("#target").empty()
                        $("#target").append(json.data)
                    }else{ alert("获取邀请码失败")}
                },
                error:function (data){
                    console.log(data)
                    alert("页面加载错误，请重试");
                }

            });
            $("#ivload").click(function() {
                EV_modeAlert('envon')
                var invitedCode=$("#target").text().trim();
                $("#invitedcode").val(invitedCode)
            })

           $("#sendVerifyCode").click( function (){
                var telephone = $("#telephone").val().trim();
                if (telephone==null || !telephone.match(/^1\d{10}$/)){
                    alert("手机号码不正确")
                }else {
                    $.ajax({
                        type: 'get',
                        url: '/pc/admin/member/sendIndentifyCode',
                        data: {telephone:telephone},
                        success: function (params) {
                            var data=eval(params)
                            var errorCode=data.errorCode
                            if (errorCode==0){

                            } else if (errorCode==4){
                                alert(data.message)
                            }
                        }

                    })
                    $("#sendVerifyCode").css("display","none");
                    $("#downtime").css("display","block");
                    countDown();
                    setTimeout(function () {
                        $("#sendVerifyCode").css("display","block");
                        $("#downtime").css("display","none");
                    }, SS*1000);


                }

            })


            $("#register").click( function (){
                $("#form").attr("enctype","multipart/form-data")
                var requestObj = eval($("#registerForm").serializeObject())
                var request =getRegeisterParams(requestObj)
                    $.ajax({
                        type: 'post',
                        url: '/pc/admin/member/register',
                        dataType:"json",
                        data: request,
                        contentType: "application/json",
                        beforeSend: function (XMLHttpRequest) {
                            XMLHttpRequest.setRequestHeader("from","2")
                        },
                        success: function (params) {
                            var data=eval(params)
                            var errorCode=data.errorCode
                            if (errorCode==0){
                                if (data.data){
                                    download()
                                }
                            } else if (errorCode==4){
                                alert(data.message)
                            }
                        }

                    })
            })

    })


    </script>
</head>
<body id="inviteby">
<div id="wrapbg" style="position:absolute; width:100%; height:100%;z-index:-1;">
    <img src="../code/img/bgone.jpg" height="100%" width="100%" />
</div>
<div class="ivwrap">
        <img class="ivbanner"src="../code/img/banner.png"/>
    <p class="ivintroduce">好友通过您的邀请码注册,即送您<span>150米币</span><br/>平台还将给您好友收入<span>10%</span>的奖励</p>
    <div class="invite">
        <img src="../code/img/invite.png"/>
        <div id="invitecode"  data-clipboard-action="copy" data-clipboard-target="#target"><span id="target">dvFgba</span></div>
    </div>
    <p class="ivusage">邀请码使用方式：<br/>APP注册页面-输入邀请码即可</p>
    <div class="ivlogo">
        <img src="../code/img/76pt-2x.png"/>
        <h5>玩着就可以<br/>赚钱的APP</h5>
    </div>
    <a id="ivload">注册并下载最新APP></a>
</div>
<!-- 弹窗样式 -->


<div id="envon">
    <h3>微淘米账户注册表</h3>
    <a class="close" href="javascript:EV_closeAlert()"><img src="../code/img/close.png"/></a>
    <form id="registerForm">
        <input type="text" name="memberName" id="memberName" value="" placeholder="请输入用户名">
        <input type="password" name="password" id="password" value="" placeholder="请输入密码">
        <div id="telverify">
            <input type="text" name="telephone" id="telephone" value="" placeholder="请输入手机号">
            <a id="sendVerifyCode" >发送验证码</a>
            <div id="downtime"></div>
        </div>
        <input type="text" name="identifyCode" class="code" value="" placeholder="请输入验证码">
        <input type="text" name="invitedCode" class="code" id="invitedcode" value="" placeholder="请输入邀请码">
    </form>
    <a id="register"> 确认并提交</a>
</div>
</body>
</html>