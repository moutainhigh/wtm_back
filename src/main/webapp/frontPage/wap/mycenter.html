<!DOCTYPE html>
<html lang="en" class="myinformation">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0" name="viewport" />
    <title>个人中心</title>
    <link href="../../code/css/base.css" rel="stylesheet" type="text/css"/>
    <link href="../../code/css/showBo.css" rel="stylesheet" type="text/css"/>
    <link href="../../code/css/wapstyle.css" rel="stylesheet" type="text/css"/>
    <link rel="stylesheet" href="../../code/css/lCalendar.css">
    <script src="../../code/js/jquery.min.js"></script>
    <script src="../../code/js/jquery.cookie.js"></script>
    <script src="../../code/js/lCalendar.js"></script>
    <script src="../../code/js/showBo.js"></script>
    <script>
        $(function(){
            initilizePage()
            var calendar = new lCalendar();
            calendar.init({
                'trigger': '#demo1',
                'type': 'date'
            });//日期插件
            var inviteheight=$(window).height();
            var invitewidth=$(window).width();
            var wayheight=$(".myinviteway").height();
            var waywidth=$(".myinviteway").width();
            $(".myinviteway").css("top",inviteheight-wayheight);
            $(".myinviteway").css("left",invitewidth/2-waywidth/2);
            $("#imgaccount").click(function(){
                $("#darkcolor").css("display","block");
                $(".myinviteway").css("display","block");
                $(".nogo").css("height",inviteheight);
                $(".nogo").css("overflow","hidden");
                $("#demo1").attr("disabled","disabled");
                $("select").attr("disabled","disabled");
            })
            $("#myinvitecancle").click(function(){
                $("#darkcolor").css("display","none");
                $(".myinviteway").css("display","none");
                $(".nogo").css("overflow","auto");
                $('#demo1').removeAttr("disabled");
                $('select').removeAttr("disabled");
            })
            var obj=document.getElementById("darkcolor");
            obj.addEventListener("touchstart",function(e){
                $("#darkcolor").css("display","none");
                $(".myinviteway").css("display","none");
                $(".nogo").css("overflow","auto");
                $(".time").click(function(){
                    $('#demo1').removeAttr("disabled");
                })
                $(".sexmi").click(function(){
                    $('select').removeAttr("disabled");
                })
            },false)
            $(".mywtm").click(function(){
                location.href="myinvite.html";
            })
            $(".openbusy").click(function(){
                $(".openbusy").css("display","none");
                $(".shop").css("display","block");
//                location.href="certificategzh.html";
            })
            if($.cookie("officialAccountList")!=null){
                $(".openbusy").css("display","none");
                $(".shop").css("display","block");
                $("#one").click(function(){
                    location.href="#";
                })
                $("#two").click(function(){
                    location.href="#";
                })
                $("#three").click(function(){
                    location.href="#";
                })
            }
            $("#demo1").on("blur", function () {
                modifyBirth();
            })
            $("#wechat").click(function(){
                if ($("#wechat>p").text()=="未绑定微信"){
                    location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2282c57276f83fad&redirect_uri=http%3a%2f%2fwww.weitaomi.cn%2fblindWXOAuth&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect";
                }
            })
        })
        function modifyBirth(){
            var date =$("#demo1").val() ;
            date = date.replace(/-/g,'/');
            var timestamp = new Date(date).getTime()/1000;
            $.ajax({
                url:"/pc/admin/member/modifyBirth",
                type:"post",
                data:{birth:timestamp},
                beforeSend: function (XMLHttpRequest) {
                    getMemberRequestHeaderMsg(XMLHttpRequest)
                },
                success: function (params) {
                    var data=eval(params)
                    var errorCode=data.errorCode
                    if (errorCode==0){
                    } else if (errorCode==4){
                        alert(data.message)
                    }
                }
            })
        }
        var getMemberRequestHeaderMsg=function(XMLHttpRequest){
            var memberId= $.cookie("memberId");
            if (memberId==null||memberId == undefined){
                Showbo.Msg.confirm("登录已过期请重新登录", function () {
                    location.href="login.html"
                })
            }
            var password= $.cookie("password");
            XMLHttpRequest.setRequestHeader("memberId",memberId);
            XMLHttpRequest.setRequestHeader("from",2);
        }
        function initilizePage(){
            if($.cookie("memberId")==null||$.cookie("memberId")==undefined){
                Showbo.Msg.alert("登录超时，请重新登录", function () {
                    location.href="login.html"
                })
            }
            $("#headimg").text(decodeURI($.cookie("memberName")))
            $(".accounttel>h6>span").text($.cookie("telephone"))
            $(".photoimg").attr("src",$.cookie("imageUrl"));
            $("#demo1").val(getLocalTime($.cookie("birth")));
            var sex=$.cookie("sex");
            $(".sexmi").find("option[value="+sex+"]").attr("selected",true);
            var thirdLogin=$.cookie("thirdLogin")
            if (thirdLogin==null||thirdLogin==undefined||thirdLogin.length<=0){
                $("#wechat>p").text("未绑定微信")
            } else{
                $("#wechat>p").text("已绑定微信")
            }
        }
        var getLocalTime=function(nS){
            return new Date(parseInt(nS) * 1000).toLocaleString().replace(/年|月/g, "-").replace(/日/g, " ");
        }
    </script>
</head>
<body class="myinformation">
<div class="nogo">
    <div class="selfinformation">
        <div id="imgaccount">
            <img class="photoimg" src="../../code/img/gzhimg.jpg"/>
            <div class="accounttel">
                <h5 id="headimg">黎沙</h5>
                <h6>手机号：<span></span></h6>
            </div>
        </div>
        <img class="mywtm" src="../../code/img/mywtm2.png"/>
    </div>
    <ul class="information">
        <li>
            <h6>生日</h6>
            <p class="time">
                <input id="demo1" type="text" readonly="" name="input_date" placeholder="1970-01-01" data-lcalendar="1970-01-1,2019-12-31" />
            </p>
        </li>
        <li>
            <h6>性别</h6>
            <p class="sexmi">
                <select>
                    <option value="2" >保密</option>
                    <option value="0">男</option>
                    <option value="1">女</option>
                </select></p>
        </li>
    </ul>
    <ul class="information">
        <li id="wechat">
            <h6>绑定微信号</h6>
            <p>未绑定微信号</p>
        </li>
        <li>
            <h6>修改登录密码</h6>
            <p></p>
        </li>
        <li>
            <h6>客服电话</h6>
            <p>0532-80801188</p>
        </li>
    </ul>
    <ul class="information">
        <li class="exit">
            <h6>退出当前账户</h6>
        </li>
    </ul>
    <img class="openbusy" src="../../code/img/Person/shop.png"/>
    <ul class="information shop">
        <li id="one">
            <h6>发布任务</h6>
        </li>
        <li id="two">
            <h6>修改登录密码</h6>
        </li>
        <li id="three">
            <h6>客服电话</h6>
        </li>
    </ul>
    <div id="darkcolor"></div>
    <ul class="myinviteway">
        <li>拍照</li>
        <li>从相册选择</li>
        <li id="myinvitecancle">取消</li>
    </ul>
</div>
</body>
</html>